# Environment example for the server
# Copy this file to .env and fill in the real values for local development.
# Do NOT commit secrets to source control. Use .env.local or a secrets manager for real tokens.

########################################
# Contentstack Configuration
########################################
# Contentstack API Host (CMA)
CONTENTSTACK_API_HOST=https://eu-api.contentstack.com

# Contentstack Delivery API (CDA)
CONTENTSTACK_DELIVERY_API=https://eu-cdn.contentstack.com

# Your Contentstack API Key (CDA)
# REQUIRED: Contentstack API Key (CDA)
CONTENTSTACK_API_KEY=your_contentstack_api_key

# REQUIRED: Your Contentstack Delivery / Preview Tokens
CONTENTSTACK_DELIVERY_TOKEN=your_contentstack_delivery_token
CONTENTSTACK_PREVIEW_TOKEN=your_contentstack_preview_token

# REQUIRED for writes: Management token (CMA) used for updates
CONTENTSTACK_MANAGEMENT_TOKEN=your_contentstack_management_token

# Contentstack Retry Configuration
CONTENTSTACK_RETRIES=3
CONTENTSTACK_CDA_RETRIES=3
CONTENTSTACK_CMA_RETRIES=3

# Environment / branch
CONTENTSTACK_ENVIRONMENT=development
CONTENTSTACK_BRANCH=main

########################################
# Server / App
########################################
NEXT_PUBLIC_API_BASE=http://localhost:3000
SERVER_PORT=3001
NODE_ENV=development
SERVER_URL=http://localhost:3001

# CORS allowed origins (comma separated)
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

########################################
# Rate limiting
########################################
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_READS=200
RATE_LIMIT_MAX_WRITES=60

########################################
# NER / spaCy microservice
########################################
# Enable NER integration (true/false)
ENABLE_NER=false

# spaCy service base URL
SPACY_SERVICE_URL=http://localhost:8000

# Optional API key forwarded to the spaCy service via `x-api-key` (leave blank if unused)
SPACY_API_KEY=

# NER rate limiting (server-side)
NER_RATE_LIMIT_WINDOW_MS=60000
NER_RATE_LIMIT_MAX=30

# Use the local fake NER implementation instead of the external spaCy service
USE_FAKE_NER=false

# Timeouts/retries/circuit breaker tuning for NER calls
NER_TIMEOUT_MS=10000
NER_RETRY_COUNT=3
NER_CIRCUIT_BREAKER_FAILURES=5
NER_CIRCUIT_BREAKER_TIMEOUT=30000
NER_CIRCUIT_BREAKER_SUCCESS=3

########################################
# Queueing / persistence
########################################
# If provided, BullMQ will use Redis at this URL. Otherwise an in-memory fallback is used.
# If provided, BullMQ will use Redis at this URL. Otherwise an in-memory fallback is used.
# For local development, a local redis is fine. For Docker demos use redis://redis:6379
REDIS_URL=redis://localhost:6379

# Optional: if you want to force the in-memory fallback (no Redis), set to 'true'
DISABLE_REDIS=false

# Worker concurrency tuning (number of batch workers to run)
# BATCH_WORKER_CONCURRENCY is used by the queue code; BULLMQ_WORKER_CONCURRENCY is a legacy alias
BATCH_WORKER_CONCURRENCY=5
BULLMQ_WORKER_CONCURRENCY=5

# For Docker demos (if you start Redis in docker-compose), use the internal service name:
# REDIS_URL=redis://redis:6379

########################################
# Logging / misc
########################################
LOG_LEVEL=info

########################################
# AI Integration (Gemini 2.5 Pro)
########################################
# AI provider (none, gemini)
AI_PROVIDER=none

# Gemini 2.5 Pro API configuration
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.0-flash-exp

# AI suggestion settings
AI_SUGGESTION_TIMEOUT=10000
AI_MAX_SUGGESTIONS=5



# CONTEXTUAL REPLACEMENT SYSTEM CONFIGURATION

# SUGGESTION CONFIDENCE THRESHOLDS
# Minimum confidence to display suggestions (0.0 - 1.0)
SUGGESTION_THRESHOLD_AI=0.7
SUGGESTION_THRESHOLD_CONTEXTUAL=0.6
SUGGESTION_THRESHOLD_HEURISTIC=0.4
SUGGESTION_THRESHOLD_BRANDKIT=0.8
SUGGESTION_THRESHOLD_MINIMUM=0.3

# SOURCE PRIORITY WEIGHTS
# Higher numbers = higher priority in ranking (1-10)
SUGGESTION_PRIORITY_AI=4
SUGGESTION_PRIORITY_CONTEXTUAL=3
SUGGESTION_PRIORITY_HEURISTIC=1
SUGGESTION_PRIORITY_BRANDKIT=5

# AUTO-APPLY THRESHOLDS
# Confidence required for automatic application (0.0 - 1.0)
SUGGESTION_AUTO_APPLY_AI=0.9
SUGGESTION_AUTO_APPLY_CONTEXTUAL=0.85
SUGGESTION_AUTO_APPLY_HEURISTIC=0.8
SUGGESTION_AUTO_APPLY_BRANDKIT=0.9


# SUGGESTION LIMITS
# Maximum number of suggestions per source
SUGGESTION_MAX_AI=5
SUGGESTION_MAX_CONTEXTUAL=3
SUGGESTION_MAX_HEURISTIC=10
SUGGESTION_MAX_BRANDKIT=8

# Maximum total suggestions to return
SUGGESTION_MAX_TOTAL=15

# DOMAIN MULTIPLIERS
# Confidence multipliers for different content domains (0.5 - 2.0)
SUGGESTION_DOMAIN_MULTIPLIER_EMAIL=1.2
SUGGESTION_DOMAIN_MULTIPLIER_VERSION=1.1
SUGGESTION_DOMAIN_MULTIPLIER_URL=1.3
SUGGESTION_DOMAIN_MULTIPLIER_BRAND=1.5
SUGGESTION_DOMAIN_MULTIPLIER_PRODUCT=1.4
SUGGESTION_DOMAIN_MULTIPLIER_CONTACT=1.2

# PERFORMANCE CONFIGURATION
# Enable suggestion caching
SUGGESTION_CACHE_ENABLED=true

# Cache TTL in seconds (3600 = 1 hour)
SUGGESTION_CACHE_TTL=3600

# Maximum cache size (number of entries)
SUGGESTION_CACHE_MAX_SIZE=1000

# Enable parallel processing for multiple suggestions
SUGGESTION_PARALLEL_PROCESSING=true

# Maximum concurrent AI requests
SUGGESTION_MAX_CONCURRENT_AI=3

# FEATURE FLAGS
# Enable/disable specific suggestion sources
SUGGESTION_ENABLE_AI=true
SUGGESTION_ENABLE_BRANDKIT=true
SUGGESTION_ENABLE_CONTEXTUAL=true
SUGGESTION_ENABLE_HEURISTIC=true

# Enable experimental features
SUGGESTION_EXPERIMENTAL_RANKING=false
SUGGESTION_EXPERIMENTAL_CLUSTERING=false

# CONTENT TYPE SPECIFIC SETTINGS
# Preferred sources for different content types (comma-separated)
SUGGESTION_CONTENT_TYPE_BLOG_SOURCES=ai,contextual,heuristic
SUGGESTION_CONTENT_TYPE_PRODUCT_SOURCES=brandkit,ai,contextual
SUGGESTION_CONTENT_TYPE_SUPPORT_SOURCES=brandkit,heuristic,ai
SUGGESTION_CONTENT_TYPE_MARKETING_SOURCES=brandkit,ai,contextual

# Content type specific thresholds
SUGGESTION_CONTENT_TYPE_BLOG_THRESHOLD=0.6
SUGGESTION_CONTENT_TYPE_PRODUCT_THRESHOLD=0.8
SUGGESTION_CONTENT_TYPE_SUPPORT_THRESHOLD=0.7
SUGGESTION_CONTENT_TYPE_MARKETING_THRESHOLD=0.8

# BRANDKIT CONFIGURATION
# External brandkit service URL (if using external service)
BRANDKIT_SERVICE_URL=

# Brandkit API key (if required)
BRANDKIT_API_KEY=

# Enable brand consistency checking
BRANDKIT_CONSISTENCY_CHECK=true

# Brand mapping cache refresh interval (seconds)
BRANDKIT_CACHE_REFRESH_INTERVAL=86400

# VALIDATION AND TESTING
# Enable suggestion validation
SUGGESTION_VALIDATION_ENABLED=true

# Validation mode (strict, moderate, lenient)
SUGGESTION_VALIDATION_MODE=moderate

# Test mode (enables additional logging and validation)
SUGGESTION_TEST_MODE=false

# Sample size for testing
SUGGESTION_TEST_SAMPLE_SIZE=20

# MONITORING AND ALERTS
# Enable suggestion quality monitoring
SUGGESTION_MONITORING_ENABLED=true

# Quality threshold for alerts (0.0 - 1.0)
SUGGESTION_QUALITY_ALERT_THRESHOLD=0.6

# Performance alert threshold (milliseconds)
SUGGESTION_PERFORMANCE_ALERT_THRESHOLD=5000

# Error rate alert threshold (percentage)
SUGGESTION_ERROR_RATE_ALERT_THRESHOLD=5

########################################
# Integrations (optional)
########################################
# Slack integration placeholders (fill if you enable Slack notifications)
SLACK_BOT_TOKEN=
SLACK_SIGNING_SECRET=
SLACK_CHANNEL2=